From stable-bounces@linux.kernel.org Wed Feb  1 02:41:48 2006
Date: Wed, 1 Feb 2006 11:41:10 +0100
From: maximilian attems <maks@sternwelten.at>
To: schwidefsky@de.ibm.com
Message-ID: <20060201104110.GA5584@nancy>
Content-Disposition: inline
Cc: Bastian Blank <waldi@debian.org>, klibc@zytor.com, stable@kernel.org,
        linux-390@vm.marist.edu
Subject: s390 klibc build fix for 2.6.15

klibc doesn't currently build on s390 since
commit 1e8e338325fa0f2bd5c1c800086e900cf188d2cd

belows patch adds some kernel ifdef for the newly added section.

Signed-off-by: maximilian attems <maks@sternwelten.at>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>


---
 include/asm-s390/setup.h |    4 ++++
 1 file changed, 4 insertions(+)

--- linux-2.6.15.3.orig/include/asm-s390/setup.h
+++ linux-2.6.15.3/include/asm-s390/setup.h
@@ -67,6 +67,8 @@ extern unsigned int console_irq;
 #define SET_CONSOLE_3215	do { console_mode = 2; } while (0)
 #define SET_CONSOLE_3270	do { console_mode = 3; } while (0)
 
+#ifdef __KERNEL__
+
 struct ipl_list_header {
 	u32 length;
 	u8  reserved[3];
@@ -114,6 +116,8 @@ extern u16 ipl_devno;
 				 IPL_PARMBLOCK_ORIGIN)
 #define IPL_PARMBLOCK_SIZE	(IPL_PARMBLOCK_START->hdr.length)
 
+#endif /* __KERNEL__ */
+
 #else 
 
 #ifndef __s390x__
