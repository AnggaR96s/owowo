From fb5131b274d7ec27c7a43f07352b26e4b65d499c Mon Sep 17 00:00:00 2001
From: Sasha Levin <sashal@kernel.org>
Date: Thu, 27 Jun 2024 15:55:17 -0400
Subject: Revert "x86/mm/numa: Use NUMA_NO_NODE when calling
 memblock_set_node()"

This reverts commit 7dc2965c852527327d2384b612909df7b7616dfa.

Signed-off-by: Sasha Levin <sashal@kernel.org>
---
 arch/x86/mm/numa.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/arch/x86/mm/numa.c b/arch/x86/mm/numa.c
index badfa96aac320..bd52ce954d59a 100644
--- a/arch/x86/mm/numa.c
+++ b/arch/x86/mm/numa.c
@@ -504,7 +504,7 @@ static void __init numa_clear_kernel_node_hotplug(void)
 	for_each_memblock(reserved, mb_region) {
 		int nid = memblock_get_region_node(mb_region);
 
-		if (nid != NUMA_NO_NODE)
+		if (nid != MAX_NUMNODES)
 			node_set(nid, reserved_nodemask);
 	}
 
@@ -624,9 +624,9 @@ static int __init numa_init(int (*init_func)(void))
 	nodes_clear(node_online_map);
 	memset(&numa_meminfo, 0, sizeof(numa_meminfo));
 	WARN_ON(memblock_set_node(0, ULLONG_MAX, &memblock.memory,
-				  NUMA_NO_NODE));
+				  MAX_NUMNODES));
 	WARN_ON(memblock_set_node(0, ULLONG_MAX, &memblock.reserved,
-				  NUMA_NO_NODE));
+				  MAX_NUMNODES));
 	/* In case that parsing SRAT failed. */
 	WARN_ON(memblock_clear_hotplug(0, ULLONG_MAX));
 	numa_reset_distance();
-- 
2.43.0

